@*
 * Copyright 2024 HM Revenue & Customs
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *@

@import uk.gov.hmrc.viewmodels.Html

@this(
    layout: templates.Layout,
    govukInsetText: GovukInsetText,
    govukErrorSummary: GovukErrorSummary,
    govukTable: GovukTable,
    govukHint: GovukHint,
    govukButton: GovukButton,
    govukLabel: GovukLabel
)

@(heading: String,
    form: Form[_],
    submitUrl: String,
    formErrorClass: String,
    errorMessages: Option[Seq[ErrorMessage]],
    inputErrorClass: String,
    searchButton: Button,
    schemes: Option[Table],
    clearLinkUrl: String,
    numberOfSchemes: Int,
    noResultsMessageKey: Option[String],
    pagination: Int,
    paginationText: String,
    pageNumber: Int,
    firstPrevNavigationLinks: Option[(uk.gov.hmrc.viewmodels.Html, uk.gov.hmrc.viewmodels.Html)],
    nextLastNavigationLinks: Option[(uk.gov.hmrc.viewmodels.Html, uk.gov.hmrc.viewmodels.Html)],
    pageNumberLinks: Seq[Int],
    returnUrl: String,
    psaName: String,
    racDac: Boolean)(implicit request: Request[_], messages: Messages)

@layout(heading) {
    <div>
        <div>

            @if(form.hasErrors) {
                @govukErrorSummary(ErrorSummary().withFormErrorsAsText(form))
            }

            <h1 class="govuk-heading-xl">@heading</h1>

            <p class="govuk-body">
                @if(racDac) {
                    @messages("messages__listSchemes__racDac")
                } else {
                    @messages("messages__listSchemes__p1_scheme")
                }
            </p>


            <form method="post"
                  autocomplete="off"
                  action="@submitUrl"
                  novalidate>

                <div class="govuk-form-group @formErrorClass govuk-!-margin-bottom-0">
                    @if(racDac){
                        @govukLabel(
                            Label(
                                content = Text(messages("messages__listSchemes__searchText_label_racDac")),
                                isPageHeading = false,
                                classes = "govuk-label--m",
                                forAttr = Some("value")
                            )
                        )
                        @govukHint(
                            Hint(
                                id = Some("value-hint"),
                                content = HtmlContent(messages("messages__listSchemes__searchText_label_hint_racDac"))
                            )
                        )
                    } else {
                        @govukLabel(
                            Label(
                                content = Text(messages("messages__listSchemes__searchText_label_scheme")),
                                isPageHeading = false,
                                classes = "govuk-label--m",
                                forAttr = Some("value")
                            )
                        )
                        @govukHint(
                            Hint(
                                id = Some("value-hint"),
                                content = HtmlContent(messages("messages__listSchemes__searchText_label_hint_scheme"))
                            )
                        )
                    }
                    @errorMessages
                    <input class="govuk-input govuk-!-width-one-half govuk-!-margin-bottom-3 @inputErrorClass" id="value" name="value" type="search"
                           value=@form.value>
                    @govukButton(searchButton)
                </div>

                @if(Option(form.value)) {
                    <p class="govuk-body">
                        <a id="clear-search-link" href="@clearLinkUrl" class="govuk-link">
                            @messages("messages__listSchemes__searchText_clearlink")
                        </a>
                    </p>
                } else {
                    @if(racDac) {
                        @govukInsetText(
                            InsetText(
                                content = HtmlContent(
                                    "<p>" + messages("messages__listSchemes__racDacOffset") + "</p>"
                                )
                            )
                        )
                    }
                }

            </form>
        </div>

        @if(Option(form.value)) {
            @if(numberOfSchemes > 0) {
                <div class="grid-row">
                    <div class="column-two-thirds" role="status">
                        <p class="govuk-margin-top-5 govuk-margin-bottom-0 govuk-body-m">
                            @if(numberOfSchemes == 1) {
                                @messages("messages__listSchemes__search_result")
                            } else {
                                @messages("messages__listSchemes__search_multipleResults", numberOfSchemes)
                            }
                        </p>
                    </div>
                </div>
            }
        }

        @if(noResultsMessageKey) {
            <div class="grid-row">
                <div class="column-two-thirds" role="status">
                    <p class="govuk-body" id="noSchemes">@noResultsMessageKey</p>
                </div>
            </div>
        }

        @if(Option(schemes)){
            @schemes.map { schemesTable => @govukTable(schemesTable)}
        }

        @if(numberOfSchemes > pagination) {
        <div class="grid-row">
            <div class="column-two-thirds">
                <p class="govuk-margin-top-5 govuk-body-s" id="pagination-text">
                    @paginationText
                </p>
                <nav class="govuk-margin-top-5" aria-label="page">
                    @if(Option(firstPrevNavigationLinks)) {
                        firstPrevNavigationLinks._1
                    }
                    @if(Option(firstPrevNavigationLinks)) {
                        firstPrevNavigationLinks._2
                    }

                    @pageNumberLinks

                    @if(Option(nextLastNavigationLinks)) {
                        nextLastNavigationLinks._1
                    }
                    @if(Option(nextLastNavigationLinks)) {
                        nextLastNavigationLinks._2
                    }
                </nav>
            </div>
        </div>
        }

        <p class="govuk-body govuk-!-margin-top-4">
            <a id="return_to_psa" href="@returnUrl" class="govuk-link">
            @messages("return.to.link", psaName)
            </a>
        </p>
    </div>
}